{"ast":null,"code":"const jwt = require('jsonwebtoken');\nconst auth = (req, res, next) => {\n  var _req$header;\n  // Get token from Authorization header\n  const token = (_req$header = req.header('Authorization')) === null || _req$header === void 0 ? void 0 : _req$header.split(' ')[1];\n  if (!token) {\n    return res.status(401).json({\n      message: 'No token, authorization denied'\n    });\n  }\n  try {\n    // Decode the token\n    const decoded = jwt.verify(token, 'SECRET_KEY'); // Use the same secret key\n    req.user = decoded; // Attach user info to request object\n    next(); // Proceed to the next middleware or route handler\n  } catch (error) {\n    res.status(403).json({\n      message: 'Invalid or expired token'\n    });\n  }\n};","map":{"version":3,"names":["jwt","require","auth","req","res","next","_req$header","token","header","split","status","json","message","decoded","verify","user","error"],"sources":["C:/Users/piteg/source/repos/p-iteghie/GamePlan/client/src/middlewares/auth.js"],"sourcesContent":["const jwt = require('jsonwebtoken');\r\n\r\nconst auth = (req, res, next) => {\r\n    // Get token from Authorization header\r\n    const token = req.header('Authorization')?.split(' ')[1];\r\n\r\n    if (!token) {\r\n        return res.status(401).json({ message: 'No token, authorization denied' });\r\n    }\r\n\r\n    try {\r\n        // Decode the token\r\n        const decoded = jwt.verify(token, 'SECRET_KEY'); // Use the same secret key\r\n        req.user = decoded;  // Attach user info to request object\r\n        next();  // Proceed to the next middleware or route handler\r\n    } catch (error) {\r\n        res.status(403).json({ message: 'Invalid or expired token' });\r\n    }\r\n};\r\n"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,cAAc,CAAC;AAEnC,MAAMC,IAAI,GAAGA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAAA,IAAAC,WAAA;EAC7B;EACA,MAAMC,KAAK,IAAAD,WAAA,GAAGH,GAAG,CAACK,MAAM,CAAC,eAAe,CAAC,cAAAF,WAAA,uBAA3BA,WAAA,CAA6BG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EAExD,IAAI,CAACF,KAAK,EAAE;IACR,OAAOH,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAiC,CAAC,CAAC;EAC9E;EAEA,IAAI;IACA;IACA,MAAMC,OAAO,GAAGb,GAAG,CAACc,MAAM,CAACP,KAAK,EAAE,YAAY,CAAC,CAAC,CAAC;IACjDJ,GAAG,CAACY,IAAI,GAAGF,OAAO,CAAC,CAAE;IACrBR,IAAI,CAAC,CAAC,CAAC,CAAE;EACb,CAAC,CAAC,OAAOW,KAAK,EAAE;IACZZ,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAA2B,CAAC,CAAC;EACjE;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}